dist: xenial
language: go

branches:
  only:
  - master
  - /^v\d+\.\d+\.\d+.*$/
  - /^release-\d+.\d+.*$/
 
git:
  depth: 1

services:
  - docker
script:
  - make ci e2e status=keep lighthouse=true
deploy:
  - provider: script
    script: bash scripts/release
    on:
      branch: master
  - provider: script
    script: bash scripts/release $TRAVIS_TAG
    skip_cleanup: true
    on:
      tags: true
